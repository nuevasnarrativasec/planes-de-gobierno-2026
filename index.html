<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planes de Gobierno 2026</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="./css/style.css?v16">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bxslider@4.2.17/dist/jquery.bxslider.min.css">
    
</head>
<body>

    <div id="header">
        <div class="ctn-header">
            <img src="./img/logo-tu-decides-color.png" alt="T√∫ Decides" width="100%" class="logo-tu-decides">
            <h1>¬øQu√© propone tu candidato?</h1>
            <h2>Una gu√≠a r√°pida para comparar planes de gobierno 2026‚Äì2031.</h2>
        </div>
    </div>

    <div class="main">
        <p class="bajada">
            <b>Analizamos los planes,  sintetizamos la informaci√≥n con ayuda de la IA y lo verificamos editorialmente. </b> Ahora podr√°s elegir un candidato o partido, filtrar por tema, mirar res√∫menes y detectar de un vistazo qu√© proponen, qu√© omiten y qu√© no cuadra. Disminuimos el ruido para ofrecerte m√°s claridad para que est√©s bien informado antes de emitir tu voto.
        </p>
        <span class="update">Actualizado al 28/10/2025</span>        

        <div class="box-titulo-seccion">
            <span class="linea-titulo-seccion"></span>
            <h3>¬øSab√≠as que?</h3>
            <p>Descubre en segundos los datos que mejor explican las propuestas</p>            
        </div>

        <!-- slider resumen candidatos -->
        <div class="slider-container">
            <img src="../img/icon-desliza-gris.png" alt="" width="100%" class="icon-desliza-gris">
            <div class="slider-resumen">
                <!-- Slide 1 -->
                <div class="slide-card card-pink">
                    <div class="card-header">
                        <h3>Cobertura por plan</h3>
                    </div>
                    <div class="card-body">
                        <h4>El m√°s amplio trata 17 temas y el m√°s acotado 8; la mayor√≠a se mueve en 14.</h4>
                        <p>
                            Muchos temas indican amplitud, no necesariamente mejor sustento.
                        </p>
                    </div>
                </div>

                <!-- Slide 2 -->
                <div class="slide-card card-blue">
                    <div class="card-header">
                        <h3>Agenda compartida</h3>
                    </div>
                    <div class="card-body">
                        <h4>Temas que aparecen en casi todos los planes: Econom√≠a, Salud, Educaci√≥n, Programas sociales, Justicia y DD. HH. y Gobernanza digital.</h4>
                        <p>Alta presencia = tema transversal en la agenda.</p>
                    </div>
                </div>

                <!-- Slide 3 -->
                <div class="slide-card card-yellow">
                    <div class="card-header">
                        <h3>Temas menos presentes</h3>
                    </div>
                    <div class="card-body">
                        <h4>Con menor aparici√≥n: Familia, Transporte, Energ√≠a y miner√≠a, Cultura y turismo y Vivienda.</h4>
                        <p>Baja presencia ‚â† irrelevancia</p>
                    </div>
                </div>

                <!-- Slide 4 -->
                <div class="slide-card card-pink">
                    <div class="card-header">
                        <h3>M√°s espacio en los planes (promedio)</h3>
                    </div>
                    <div class="card-body">
                        <h4>Los planes dedican m√°s espacio a Econom√≠a (18%) y Salud (14%).</h4>
                        <p>M√°s porcentaje = m√°s espacio, no mejor propuesta.</p>
                    </div>
                </div>

                <!-- Slide 5 -->
                <div class="slide-card card-blue">
                    <div class="card-header">
                        <h3>Menos espacio en los planes (promedio)</h3>
                    </div>
                    <div class="card-body">
                        <h4>Familia (1,5%) y Transporte (1,6%) reciben menos menciones.</h4>
                        <p>Poco espacio no representa calidad.</p>
                    </div>
                </div>

                <!-- Slide 6 -->
                <div class="slide-card card-yellow">
                    <div class="card-header">
                        <h3>Tema dominante por plan</h3>
                    </div>
                    <div class="card-body">
                        <h4>En la mayor√≠a de planes el tema n.¬∫ 1 es Econom√≠a; en varios, Salud o Programas sociales.</h4>
                        <p>Muestra prioridad, mas no la profundidad.</p>
                    </div>
                </div>

                <!-- Slide 7 -->
                <div class="slide-card card-pink">
                    <div class="card-header">
                        <h3>Tono predominante</h3>
                    </div>
                    <div class="card-body">
                        <h4>Predominan los tonos social y pragm√°tico; el t√©cnico es minoritario y el ideol√≥gico aparece en diversa intensidad. </h4>
                        <p>Esto describe c√≥mo se propone, no si es cierto.</p>
                    </div>
                </div>

                <!-- Slide 8 -->
                <div class="slide-card card-blue">
                    <div class="card-header">
                        <h3>Coherencia interna</h3>
                    </div>
                    <div class="card-body">
                        <h4>La evaluaci√≥n global se concentra en coherencia alta o media; la baja es minoritaria.</h4>
                        <p>Que est√© bien estructurado no representa que sea correcto.</p>
                    </div>
                </div>

            </div>
        </div>

        <p class="elige">Elige la opci√≥n que prefieras para iniciar </p>
        <ul class="anclas">
            <li>
                Candidato o partido
            </li>
            <li>
                Compara planes
            </li>
            <li>
                Panorama general
            </li>
        </ul>

        <!-- buscador de candidatos y partidos -->
        <div id="box-main-candidatos">
            <span class="linea-titulo-seccion"></span>
            <h3>Explora por candidato o partido</h3>
            <p class="bajada-candidatos">
                Encuentra res√∫menes claros de cada plan y accede a una versi√≥n concisa de los temas principales que aborda.
            </p>
            <div class="container">
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('partido')">Partidos</button>
                    <button class="tab" onclick="switchTab('candidato')">Candidatos</button>
                </div>

                <div class="search-container">
                    <div class="search-box">
                        <input type="text" id="searchInput" placeholder="Buscar" onkeyup="filterItems()">
                        <span class="search-icon">
                            <img src="../img/lupa.png" alt="" width="100%">
                        </span>
                    </div>
                </div>

                <div class="content">
                    <div class="sidebar" id="itemList">
                        <!-- Items will be loaded here -->
                    </div>

                    <div class="detail-panel" id="detailPanel">
                        <div class="empty-state">
                            Selecciona un partido o candidato para ver los detalles
                        </div>
                    </div>
                </div>
            </div>  
        </div>

        <!-- Secci√≥n de Comparador -->
        <div class="comparison-section" id="comparisonSection">
            <div class="comparison-header">
                <span class="linea-titulo-seccion"></span>
                <h2>¬øA√∫n con dudas? Compara tus principales opciones</h2>
                <p>Selecciona hasta 3 candidatos y contrasta sus propuestas por tema, tono y coherencia. Adem√°s, incluye un breve fact-checking.</p>
                
                <div class="theme-selector">
                    <div class="theme-dropdown">
                        <select id="themeSelector" onchange="updateComparisonTheme()">
                            <option value="">Temas</option>
                            <option value="educacion">Educaci√≥n</option>
                            <option value="economia">Econom√≠a</option>
                            <option value="salud">Salud</option>
                            <!--<option value="seguridad">Seguridad</option>
                            <option value="infraestructura">Infraestructura</option>
                            <option value="medio-ambiente">Medio Ambiente</option>-->
                        </select>
                    </div>
                </div>
            </div>

            <div class="comparison-grid" id="comparisonGrid">
                <!-- Las tarjetas de comparaci√≥n se generar√°n aqu√≠ -->
            </div>
        </div>

        <div class="box-titulo-seccion">
            <span class="linea-titulo-seccion"></span>
            <h3>Panorama general</h3>
        </div>

        <!-- panorama general -->
        <div class="box-main-panorama">
            <h2>Diversidad tem√°tica</h2>
            <p>
                Aqu√≠ ver√°s la variedad de √°reas tratadas en el plan. Un plan con muchos temas ofrece una mayor cobertura, aunque no siempre puede entrar en detalle ni mostrar sustento en cada √°rea.
            </p>

            <div class="box-flourish">
                <div class="flourish-embed flourish-chart" data-src="visualisation/25750063"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/25750063/thumbnail" width="100%" alt="chart visualization" /></noscript></div>
            </div>

            <h2>Densidad discursiva</h2>
            <p>
                Descubre el porcentaje del plan que ocupa cada tema. M√°s espacio no implica mayor concreci√≥n ni mejor sustento.
            </p>

            <!-- Secci√≥n de Densidad Discursiva -->
            <div class="density-section" id="densitySection">

                <div class="density-controls">
                    <div class="party-selector">
                        <select id="densityPartyFilter" onchange="updateDensityFilter()">
                            <option value="">Todos</option>
                        </select>
                    </div>

                    <div class="theme-slider-container">
                        <div class="theme-slider" id="themeSlider">
                            <div class="theme-segments" id="themeSegments">
                                <!-- Segmentos se generar√°n din√°micamente -->
                            </div>
                            <div class="slider-handle" id="sliderHandle"></div>
                        </div>
                        <div class="theme-labels" id="themeLabels">
                            <!-- Labels se generar√°n din√°micamente -->
                        </div>
                    </div>
                </div>

                <div class="party-list" id="partyDensityList">
                    <!-- Lista de partidos con barras se generar√° aqu√≠ -->
                </div>
            </div>


            <h2>Prevalencia tem√°tica</h2>
            <p>
                Mide en cu√°ntos partidos aparece cada tema. Un valor m√°s alto indica un tema m√°s transversal en la agenda. No eval√∫a detalle, coherencia ni evidencia.
            </p>

            <div class="box-flourish">
                <div class="flourish-embed flourish-hierarchy" data-src="visualisation/25769480"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/25769480/thumbnail" width="100%" alt="hierarchy visualization" /></noscript></div>
            </div>

        </div>

        <div class="box-metodologia">
            <h6>metodolog√≠a</h6>
            <p>
                Este especial se basa en informaci√≥n p√∫blica de los planes de gobierno que cada partido suministra al JNE. Los documentos se procesaron con el programa de automatizaci√≥n n8n para su lectura, limpieza, estandarizaci√≥n y unificaci√≥n. El contenido se clasific√≥ por temas con asistencia de IA y se calcularon indicadores como diversidad tem√°tica, densidad discursiva y prevalencia. Para los res√∫menes finales se emplearon modelos de OpenAI y Gemini, con edici√≥n y validaci√≥n editorial antes de la publicaci√≥n. El resultado es una s√≠ntesis comparable y clara, pensada para consulta r√°pida sin perder rigor.
            </p>
            <p>
                Para caracterizar el tono y la coherencia se aplic√≥ un enfoque de an√°lisis del discurso pol√≠tico (referencias: van Dijk, Fairclough, Habermas) y coherencia program√°tica (Klingemann et al.). El tono se etiqueta por fragmento como: T√©cnico (gesti√≥n p√∫blica, evidencia, indicadores), Ideol√≥gico (valores, principios, identidad), Pragm√°tico (acciones viables, implementaci√≥n) o Social (inclusi√≥n, bienestar, equidad). La coherencia interna se valora en Alta / Media / Baja seg√∫n el alineamiento entre diagn√≥stico y medidas, la ausencia de contradicciones y la claridad de metas.
            </p>
        </div>


    </div>

    <div class="box-footer">
        <img src="./img/logo-comercio.png" alt="El Comercio" width="100%" class="logo-comercio">
        <ul>
            <li>
                <p>
                    <span>Investigaci√≥n y textos:</span>
                </p>
            </li>
            <li>
                <p>
                    Gisella Salm√≥n
                </p>
            </li>
            <li>
                <p>
                    Mayt√© Ciriaco
                </p>
            </li>
            <li>
                <p>
                    Lorena Obreg√≥n
                </p>
            </li>

            <li>
                <p>
                    <span>Dise√±o:</span>
                </p>
            </li>
            <li>
                <p>
                    Marcelo Hidalgo
                </p>
            </li>

            <li>
                <p>
                    <span>Ilustraciones y animaci√≥n:</span>
                </p>
            </li>
            <li>
                <p>
                    Kiomy Kanashiro
                </p>
            </li>
        </ul>

        <ul>
            <li>
                <p>
                    <span>Programaci√≥n:</span>
                </p>
            </li>
            <li>
                <p>
                    Armando Scargglioni C.
                </p>
            </li>
            <li>
                <p>
                    Edici√≥n visual:
                </p>
            </li>
            <li>
                <p>
                    Angela Pe√±a
                </p>
            </li>

            <li>
                <p>
                    <span>Producci√≥n general:</span>
                </p>
            </li>
            <li>
                <p>
                    Gisella Salm√≥n
                </p>
            </li>

            <li>
                <p>
                    <span>Director period√≠stico:</span>
                </p>
            </li>
            <li>
                <p>
                    Juan Aurelio Ar√©valo
                </p>
            </li>
        </ul>
    </div>

    

    <!-- scripts -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bxslider@4.2.17/dist/jquery.bxslider.min.js"></script>

    <!-- carrusel resumen -->
    <script>
        $(document).ready(function(){
            var slider;
            
            function initSlider() {
                if (slider) {
                    slider.destroySlider();
                }
                
                var windowWidth = $(window).width();
                var isMobile = windowWidth <= 768;
                var isSmallMobile = windowWidth <= 480;
                
                slider = $(".slider-resumen").bxSlider({
                    slideWidth: isSmallMobile ? windowWidth - 80 : (isMobile ? windowWidth - 100 : 380),
                    minSlides: 1,
                    maxSlides: isMobile ? 1 : 3,
                    moveSlides: 1,
                    slideMargin: 20,
                    infiniteLoop: false,
                    hideControlOnEnd: true,
                    pager: false,
                    controls: true
                });
            }
            
            initSlider();
            
            var resizeTimer;
            $(window).resize(function() {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(function() {
                    initSlider();
                }, 250);
            });
        });
    </script>

    <!-- anclas botones -->
    <script>
        // Smooth scroll para las anclas
            document.addEventListener('DOMContentLoaded', function() {
                // Obtener todos los elementos li del men√∫ de anclas
                const anchorItems = document.querySelectorAll('ul.anclas li');
                
                // Mapeo de los li con sus correspondientes divs
                const sections = [
                    { element: anchorItems[0], target: '#box-main-candidatos' },
                    { element: anchorItems[1], target: '#comparisonSection' },
                    { element: anchorItems[2], target: '.box-main-panorama' }
                ];
                
                // Agregar event listeners a cada li
                sections.forEach(function(section) {
                    if (section.element) {
                        section.element.addEventListener('click', function() {
                            const targetElement = document.querySelector(section.target);
                            
                            if (targetElement) {
                                // Scroll suave hacia el elemento
                                targetElement.scrollIntoView({
                                    behavior: 'smooth',
                                    block: 'start'
                                });
                                
                                // Opcional: agregar clase active al li clickeado
                                anchorItems.forEach(item => item.classList.remove('active'));
                                section.element.classList.add('active');
                            }
                        });
                    }
                });
            });
    </script>

    <!-- buscador y comparador de candidatos o partidos -->
    <script>
        // ============================================
        // CONFIGURACI√ìN: URLs de Google Spreadsheets
        // ============================================
        
        // Hoja 1: Datos generales de partidos y candidatos
        const SPREADSHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR_yZQbmqUse6lOcFRxBhP53YkC3CdIc36YcOE3bk-w_91-TVudDvH9uVuJoSMZwf_4bPPuq--qbHKb/pub?output=csv';
        
        // Hoja 2: Datos de comparaci√≥n por temas
        const COMPARISON_SPREADSHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRcgvr6YP_YLsgXS9-mJD34bBug-Qzlv8W_d3ZacfQhYcM-7u85u-U6TCl8S9rsBDVPD8Ck5mMsYNxW/pub?output=csv';
        
        // ============================================
        // Funciones de Cache-Busting
        // ============================================
        
        // Agregar timestamp para evitar cach√©
        function addCacheBuster(url) {
            const separator = url.includes('?') ? '&' : '?';
            return `${url}${separator}_=${new Date().getTime()}`;
        }        
        
        // ============================================
        // Variables globales - Secci√≥n Buscador
        // ============================================
        let currentTab = 'partido';
        let allData = [];
        let filteredData = [];
        
        // ============================================
        // Variables globales - Secci√≥n Densidad Discursiva
        // ============================================
        
        // URL del archivo JSON con datos de densidad
        const DENSITY_DATA_URL = './data/densidad-data.json';
        
        const themes = [
            { id: 'educacion', name: 'EDUCACI√ìN', color: '#3B82F6' },
            { id: 'salud', name: 'SALUD', color: '#EF4444' },
            { id: 'economia', name: 'ECONOM√çA', color: '#10B981' },
            { id: 'seguridad', name: 'SEGURIDAD', color: '#F59E0B' },
            { id: 'infraestructura', name: 'INFRAESTRUCTURA', color: '#8B5CF6' },
            { id: 'medio-ambiente', name: 'MEDIO AMBIENTE', color: '#06B6D4' }
        ];
        
        let selectedThemeIndex = 1; // Por defecto: SALUD
        let densityFilteredParty = '';
        let densityData = {};

        // ============================================
        // Funciones de Densidad Discursiva
        // ============================================

        // Cargar datos de densidad desde JSON
        async function loadDensityData() {
            try {
                const response = await fetch(DENSITY_DATA_URL);
                if (!response.ok) {
                    throw new Error('Error al cargar datos de densidad');
                }
                const data = await response.json();
                
                // Convertir array a objeto indexado por ID
                densityData = {};
                data.partidos.forEach(partido => {
                    densityData[partido.id] = {
                        partido: partido.nombre,
                        logoUrl: partido.logoUrl || '',
                        temas: partido.densidad
                    };
                });
                
                console.log('üìä Datos de densidad cargados:', densityData);
                return densityData;
            } catch (error) {
                console.error('‚ùå Error cargando datos de densidad:', error);
                console.log('‚ö†Ô∏è Usando datos de ejemplo...');
                
                // Datos de ejemplo si falla la carga
                densityData = {
                    "1": {
                        partido: "Partido 1",
                        logoUrl: "",
                        temas: {
                            educacion: 15,
                            salud: 25,
                            economia: 20,
                            seguridad: 18,
                            infraestructura: 12,
                            "medio-ambiente": 10
                        }
                    },
                    "2": {
                        partido: "Partido 2",
                        logoUrl: "",
                        temas: {
                            educacion: 22,
                            salud: 28,
                            economia: 15,
                            seguridad: 10,
                            infraestructura: 15,
                            "medio-ambiente": 10
                        }
                    }
                };
                return densityData;
            }
        }

        // Inicializar slider de temas
        function initThemeSlider() {
            const segmentsContainer = document.getElementById('themeSegments');
            const labelsContainer = document.getElementById('themeLabels');
            const slider = document.getElementById('themeSlider');
            
            // Crear segmentos SIN labels dentro
            segmentsContainer.innerHTML = themes.map((theme, index) => `
                <div class="theme-segment theme-${theme.id} ${index === selectedThemeIndex ? 'active' : ''}" 
                     data-index="${index}"
                     onclick="selectTheme(${index})">
                </div>
            `).join('');
            
            // Crear labels fuera de los segmentos
            labelsContainer.innerHTML = themes.map((theme, index) => `
                <div class="theme-label-item ${index === selectedThemeIndex ? 'active' : ''}" 
                     data-index="${index}">
                    ${theme.name}
                </div>
            `).join('');
            
            // Posicionar handle en el centro del segmento
            updateSliderHandle();
            
            // Hacer el slider clickeable
            slider.addEventListener('click', (e) => {
                if (e.target.classList.contains('theme-segment') || e.target.closest('.theme-segment')) {
                    return; // Ya manejado por onclick del segmento
                }
                handleSliderDrag(e.clientX);
            });
        }

        // Manejar arrastre del slider
        function handleSliderDrag(clientX) {
            const slider = document.getElementById('themeSlider');
            const rect = slider.getBoundingClientRect();
            const x = clientX - rect.left;
            const percentage = Math.max(0, Math.min(1, x / rect.width));
            const newIndex = Math.round(percentage * (themes.length - 1));
            
            if (newIndex !== selectedThemeIndex) {
                selectTheme(newIndex);
            }
        }

        // Seleccionar tema
        function selectTheme(index) {
            selectedThemeIndex = index;
            
            // Actualizar segmentos activos y dimmed
            document.querySelectorAll('.theme-segment').forEach((seg, i) => {
                seg.classList.toggle('active', i === index);
                seg.classList.toggle('dimmed', i !== index);
            });
            
            // Actualizar labels activos
            document.querySelectorAll('.theme-label-item').forEach((label, i) => {
                label.classList.toggle('active', i === index);
            });
            
            // Actualizar handle
            updateSliderHandle();
            
            // Actualizar visualizaci√≥n
            renderDensityBars();
        }

        // Actualizar posici√≥n del handle
        function updateSliderHandle() {
            const slider = document.getElementById('themeSlider');
            const handle = document.getElementById('sliderHandle');
            const segments = document.querySelectorAll('.theme-segment');
            
            if (segments.length === 0) return;
            
            // Obtener el segmento activo
            const activeSegment = segments[selectedThemeIndex];
            const segmentRect = activeSegment.getBoundingClientRect();
            const sliderRect = slider.getBoundingClientRect();
            
            // Posicionar el handle en el centro del segmento
            const segmentCenter = segmentRect.left - sliderRect.left + (segmentRect.width / 2);
            handle.style.left = `${segmentCenter}px`;
        }

        // Renderizar barras de densidad
        function renderDensityBars() {
            const container = document.getElementById('partyDensityList');
            const selectedTheme = themes[selectedThemeIndex].id;
            const isMobile = window.innerWidth <= 768;
            
            // Filtrar partidos si hay selecci√≥n
            let partidosToShow = Object.keys(densityData);
            if (densityFilteredParty) {
                partidosToShow = partidosToShow.filter(id => id == densityFilteredParty);
            }
            
            if (isMobile) {
                // Layout m√≥vil: cada partido con su nombre y barra juntos
                container.className = 'party-list mobile-view';
                container.innerHTML = partidosToShow.map(partidoId => {
                    const partido = densityData[partidoId];
                    const highlightClass = densityFilteredParty == partidoId ? 'highlighted' : '';
                    
                    const logoHTML = partido.logoUrl 
                        ? `<img src="${partido.logoUrl}" alt="${partido.partido}" onerror="this.style.display='none';">` 
                        : 'üçé';
                    
                    const segmentsHTML = themes.map((theme, themeIndex) => {
                        const percentage = partido.temas[theme.id] || 0;
                        const isSelected = theme.id === selectedTheme;
                        const dimmedClass = selectedTheme ? (isSelected ? 'highlighted' : 'dimmed') : '';
                        
                        return `
                            <div class="density-segment theme-${theme.id} ${dimmedClass}" 
                                 style="width: ${percentage}%"
                                 data-theme="${theme.id}"
                                 data-theme-index="${themeIndex}"
                                 onclick="selectThemeFromBar(${themeIndex})">
                                <div class="density-tooltip">${theme.name}: ${percentage}%</div>
                            </div>
                        `;
                    }).join('');
                    
                    return `
                        <div class="party-complete-item ${highlightClass}">
                            <div class="party-complete-header">
                                <div class="party-density-icon">${logoHTML}</div>
                                <div class="party-density-name">${partido.partido}</div>
                            </div>
                            <div class="party-complete-bar">
                                <div class="party-density-bar-container">
                                    <div class="party-density-bar">
                                        ${segmentsHTML}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            } else {
                // Layout desktop: dos columnas
                container.className = 'party-list';
                
                // Crear columna de nombres
                const namesHTML = partidosToShow.map(partidoId => {
                    const partido = densityData[partidoId];
                    const logoHTML = partido.logoUrl 
                        ? `<img src="${partido.logoUrl}" alt="${partido.partido}" onerror="this.style.display='none';">` 
                        : 'üçé';
                    const highlightClass = densityFilteredParty == partidoId ? 'highlighted' : '';
                    
                    return `
                        <div class="party-name-item ${highlightClass}">
                            <div class="party-density-item">
                                <div class="party-density-icon">${logoHTML}</div>
                                <div class="party-density-name">${partido.partido}</div>
                            </div>
                        </div>
                    `;
                }).join('');
                
                // Crear columna de barras
                const barsHTML = partidosToShow.map(partidoId => {
                    const partido = densityData[partidoId];
                    const highlightClass = densityFilteredParty == partidoId ? 'highlighted' : '';
                    
                    const segmentsHTML = themes.map((theme, themeIndex) => {
                        const percentage = partido.temas[theme.id] || 0;
                        const isSelected = theme.id === selectedTheme;
                        const dimmedClass = selectedTheme ? (isSelected ? 'highlighted' : 'dimmed') : '';
                        
                        return `
                            <div class="density-segment theme-${theme.id} ${dimmedClass}" 
                                 style="width: ${percentage}%"
                                 data-theme="${theme.id}"
                                 data-theme-index="${themeIndex}"
                                 onclick="selectThemeFromBar(${themeIndex})">
                                <div class="density-tooltip">${theme.name}: ${percentage}%</div>
                            </div>
                        `;
                    }).join('');
                    
                    return `
                        <div class="party-bar-item ${highlightClass}">
                            <div class="party-density-bar-container">
                                <div class="party-density-bar">
                                    ${segmentsHTML}
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
                
                container.innerHTML = `
                    <div class="party-names-column">
                        ${namesHTML}
                    </div>
                    <div class="party-bars-column">
                        ${barsHTML}
                    </div>
                `;
            }
        }

        // Seleccionar tema desde la barra de un partido
        function selectThemeFromBar(themeIndex) {
            selectTheme(themeIndex);
            
            // Scroll suave al slider
            const slider = document.getElementById('themeSlider');
            slider.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // Actualizar filtro de partido
        function updateDensityFilter() {
            densityFilteredParty = document.getElementById('densityPartyFilter').value;
            renderDensityBars();
        }

        // Poblar selector de partidos
        function populateDensityPartySelector() {
            const select = document.getElementById('densityPartyFilter');
            
            const options = Object.keys(densityData).map(partidoId => {
                const partido = densityData[partidoId];
                return `<option value="${partidoId}">${partido.partido}</option>`;
            }).join('');
            
            select.innerHTML = '<option value="">Todos los partidos</option>' + options;
        }

        // ============================================
        // Variables globales - Secci√≥n Comparador
        // ============================================
        let comparisonDataList = [];
        let selectedComparisons = [null, null, null]; // M√°ximo 3 comparaciones
        let currentComparisonTheme = '';

        // ============================================
        // Funciones del Comparador
        // ============================================

        // Cargar datos de comparaci√≥n desde Google Sheets
        async function loadComparisonData() {
            try {
                const response = await fetch(addCacheBuster(COMPARISON_SPREADSHEET_URL));
                if (!response.ok) {
                    throw new Error('Error al cargar datos de comparaci√≥n');
                }
                const csvText = await response.text();
                comparisonDataList = parseCSV(csvText);
                console.log('‚úÖ Datos de comparaci√≥n cargados:', comparisonDataList);
                console.log('üìä Total de registros:', comparisonDataList.length);
                console.log('üîë Columnas disponibles:', Object.keys(comparisonDataList[0] || {}));
                return comparisonDataList;
            } catch (error) {
                console.error('‚ùå Error cargando datos de comparaci√≥n:', error);
                alert('Error al cargar los datos de comparaci√≥n. Verifica que la URL del Google Sheet sea correcta y que est√© publicado como CSV.');
                return [];
            }
        }

        // Actualizar tema de comparaci√≥n
        function updateComparisonTheme() {
            currentComparisonTheme = document.getElementById('themeSelector').value;
            renderComparisonCards();
        }

        // Renderizar tarjetas de comparaci√≥n
        function renderComparisonCards() {
            const grid = document.getElementById('comparisonGrid');
            
            // S√≥lo usar elementos de tipo 'partido' para las opciones del comparador
            const partyOptions = allData.filter(d => d.tipo === 'partido');
            
            grid.innerHTML = selectedComparisons.map((item, index) => {
                if (!item) {
                    return `
                        <div class="comparison-card empty">
                            <div style="font-size: 48px; color: #ddd;">+</div>
                            <p>Selecciona un partido</p>
                            <div class="card-selector" style="width: 100%; max-width: 250px;">
                                <select onchange="addToComparison(${index}, this.value)">
                                    <option value="">Partido</option>
                                    ${partyOptions.map(d => `<option value="${d.id}">${d.nombre}</option>`).join('')}
                                </select>
                            </div>
                        </div>
                    `;
                }
                
                return renderComparisonCard(item, index);
            }).join('');
        }

        // Renderizar una tarjeta de comparaci√≥n con datos
        function renderComparisonCard(item, index) {
            const compData = comparisonDataList.find(c => 
                c.partidoId == item.id && c.tema === currentComparisonTheme
            );
            
            console.log('Buscando datos para:', {
                partidoId: item.id,
                tema: currentComparisonTheme,
                encontrado: compData,
                todosLosDatos: comparisonDataList
            });
            
            if (!compData && currentComparisonTheme) {
                return `
                    <div class="comparison-card">
                        <button class="remove-card" onclick="removeFromComparison(${index})">√ó</button>
                        <div class="card-profile">
                            <div class="card-avatar">
                                ${item.fotoUrl ? `<img src="${item.fotoUrl}" alt="${item.candidato}">` : '<div class="card-avatar-icon"></div><div class="card-avatar-body"></div>'}
                            </div>
                            <div class="card-name">${item.candidato}</div>
                            <div class="card-party">${item.nombre}</div>
                        </div>
                        <p style="text-align: center; color: #999; padding: 40px 20px;">
                            No hay informaci√≥n disponible para este tema
                        </p>
                    </div>
                `;
            }
            
            const avatarHTML = item.fotoUrl 
                ? `<img src="${item.fotoUrl}" alt="${item.candidato}" onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=\\'card-avatar-icon\\'></div><div class=\\'card-avatar-body\\'></div>';">` 
                : '<div class="card-avatar-icon"></div><div class="card-avatar-body"></div>';
            
            if (!currentComparisonTheme) {
                // S√≥lo mostrar partidos en el select de cambio
                const partyOptions = allData.filter(d => d.tipo === 'partido' && d.id != item.id);
                
                return `
                    <div class="comparison-card">
                        <button class="remove-card" onclick="removeFromComparison(${index})">√ó</button>
                        <div class="card-selector">
                            <select onchange="changeComparison(${index}, this.value)">
                                <option value="${item.id}" selected>${item.nombre}</option>
                                ${partyOptions.map(d => 
                                    `<option value="${d.id}">${d.nombre}</option>`
                                ).join('')}
                            </select>
                        </div>
                        <div class="card-profile">
                            <div class="card-avatar">${avatarHTML}</div>
                            <div class="card-name">${item.candidato || item.nombre}</div>
                            <div class="card-party">${item.nombre}</div>
                        </div>
                        <p style="text-align: center; color: #999; padding: 40px 20px;">
                            Selecciona un tema arriba para ver las propuestas
                        </p>
                    </div>
                `;
            }
            
            // Renderizar con datos completos
            const propuestasHTML = compData.propuestas ? 
                `<ul>${compData.propuestas.split('\n').filter(p => p.trim()).map(p => `<li>${p.replace(/^- /, '')}</li>`).join('')}</ul>` 
                : '<p>No hay propuestas disponibles</p>';
            
            // Parsear los factchecks individuales
            let factcheckHTML = '';
            if (compData.factcheckIntro || compData.factcheck1Propuesta) {
                const factchecks = [];
                
                // Recopilar todos los factchecks disponibles
                for (let i = 1; i <= 5; i++) {
                    const propuesta = compData[`factcheck${i}Propuesta`];
                    if (propuesta) {
                        factchecks.push({
                            propuesta: propuesta,
                            descripcion: compData[`factcheck${i}Descripcion`] || '',
                            veracidad: compData[`factcheck${i}Veracidad`] || 'doubtful',
                            explicacion: compData[`factcheck${i}Explicacion`] || ''
                        });
                    }
                }
                
                if (factchecks.length > 0) {
                    const veracidadLabels = {
                        'false': 'FALSO',
                        'true': 'VERDADERO',
                        'partially': 'PARCIALMENTE CIERTO',
                        'doubtful': 'DUDOSO'
                    };
                    
                    factcheckHTML = factchecks.map(fc => `
                        <div class="factcheck-item">
                            <div class="factcheck-proposal">${fc.propuesta}</div>
                            ${fc.descripcion ? `<div class="factcheck-description">${fc.descripcion}</div>` : ''}
                            <div class="fact-label ${fc.veracidad}">${veracidadLabels[fc.veracidad] || 'DUDOSO'}</div>
                            ${fc.explicacion ? `<div class="factcheck-explanation"><strong>Explicaci√≥n:</strong> ${fc.explicacion}</div>` : ''}
                        </div>
                    `).join('');
                }
            }
            
            return `
                <div class="comparison-card">
                    <button class="remove-card" onclick="removeFromComparison(${index})">√ó</button>
                    <div class="card-selector">
                        <select onchange="changeComparison(${index}, this.value)">
                            <option value="${item.id}" selected>${item.nombre}</option>
                            ${allData.filter(d => d.id != item.id && d.tipo === 'partido').map(d => 
                                `<option value="${d.id}">${d.nombre}</option>`
                            ).join('')}
                        </select>
                    </div>
                    <div class="card-profile">
                        <div class="card-avatar">${avatarHTML}</div>
                        <div class="card-name">${item.candidato || item.nombre}</div>
                        <div class="card-party">${item.nombre}</div>
                    </div>
                    <div class="card-content">
                        <div class="content-section">
                            <h4>${currentComparisonTheme.toUpperCase()}</h4>
                            ${propuestasHTML}
                        </div>
                        ${compData.tonoDiscursivo || compData.coherencia ? `
                            <div class="discourse-tone">
                                <p><strong>Tono discursivo:</strong> ${compData.tonoDiscursivo || 'N/A'}</p>
                                <p><strong>Coherencia:</strong> ${compData.coherencia || 'N/A'}</p>
                            </div>
                        ` : ''}
                        ${factcheckHTML ? `
                            <div class="factcheck-section">
                                <h4>FACTCHECKING</h4>
                                ${compData.factcheckIntro ? `<div class="factcheck-intro">${compData.factcheckIntro}</div>` : ''}
                                ${factcheckHTML}
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        // Agregar partido/candidato a la comparaci√≥n
        function addToComparison(index, itemId) {
            if (!itemId) return;
            
            // S√≥lo permitir partidos
            const item = allData.find(d => d.id == itemId && d.tipo === 'partido');
            if (item) {
                selectedComparisons[index] = item;
                renderComparisonCards();
            } else {
                alert('Solo se pueden seleccionar partidos para la comparaci√≥n.');
            }
        }

        // Cambiar partido/candidato en la comparaci√≥n
        function changeComparison(index, itemId) {
            if (!itemId) return;
            
            // S√≥lo permitir partidos
            const item = allData.find(d => d.id == itemId && d.tipo === 'partido');
            if (item) {
                selectedComparisons[index] = item;
                renderComparisonCards();
            } else {
                alert('Solo se pueden seleccionar partidos para la comparaci√≥n.');
            }
        }

        // Remover de la comparaci√≥n
        function removeFromComparison(index) {
            selectedComparisons[index] = null;
            renderComparisonCards();
        }

        // Funci√≥n mejorada de scroll a la secci√≥n de comparar
        function scrollToCompare() {
            const comparisonSection = document.getElementById('comparisonSection');
            comparisonSection.scrollIntoView({ behavior: 'smooth' });
        }

        // Agregar al comparador desde el bot√≥n "Comparar" del detalle
        function addToCompare(item) {
            // Si nos pasaron un string id, intentar resolver
            if (typeof item === 'string' || typeof item === 'number') {
                const resolved = allData.find(d => d.id == item && d.tipo === 'partido');
                if (!resolved) {
                    alert('Solo puedes comparar partidos. Selecciona un partido desde la pesta√±a "Partidos".');
                    return;
                }
                item = resolved;
            }
            
            // Si el objeto no es tipo partido, intentar mapear al partido correspondiente
            if (item.tipo !== 'partido') {
                // Buscar partido por nombre de partido en el registro del candidato
                const partyName = item.nombrePartido || item.partido || item.nombre;
                const partido = allData.find(d => d.tipo === 'partido' && d.nombre === partyName);
                
                if (partido) {
                    item = partido;
                } else {
                    alert('No es posible a√±adir candidatos al comparador. S√≥lo se permiten partidos.');
                    return;
                }
            }
            
            // Buscar el primer espacio vac√≠o
            const emptyIndex = selectedComparisons.findIndex(c => c === null);
            
            if (emptyIndex !== -1) {
                selectedComparisons[emptyIndex] = item;
                renderComparisonCards();
                scrollToCompare();
            } else {
                // Si ya hay 3 partidos, reemplazar el √∫ltimo
                selectedComparisons[2] = item;
                renderComparisonCards();
                scrollToCompare();
            }
        }

        // ============================================
        // Funciones del Buscador Principal
        // ============================================

        // Funci√≥n para refrescar todos los datos (sin UI, para uso program√°tico)
        async function refreshAllData() {
            try {
                console.log('üîÑ Refrescando todos los datos...');
                
                // Recargar datos del buscador
                await loadDataFromGoogleSheets();
                
                // Recargar datos del comparador
                await loadComparisonData();
                
                // IMPORTANTE: Forzar re-render del comparador despu√©s de cargar
                console.log('üîÑ Actualizando tarjetas del comparador...');
                renderComparisonCards();
                
                // Recargar datos de densidad
                await loadDensityData().then(() => {
                    populateDensityPartySelector();
                    renderDensityBars();
                });
                
                console.log('‚úÖ Todos los datos actualizados correctamente');
                console.log('üìä Comparaciones:', selectedComparisons);
                console.log('üìä Datos de comparaci√≥n:', comparisonDataList.length, 'registros');
                
            } catch (error) {
                console.error('‚ùå Error al refrescar datos:', error);
            }
        }

        // Inicializar la aplicaci√≥n
        function init() {
            loadDataFromGoogleSheets();
            loadComparisonData();
            renderComparisonCards();
            
            // Cargar y renderizar densidad discursiva
            loadDensityData().then(() => {
                initThemeSlider();
                populateDensityPartySelector();
                renderDensityBars();
                
                // Reposicionar handle en resize
                window.addEventListener('resize', () => {
                    updateSliderHandle();
                });
            });
            
            // Atajo de teclado opcional: Ctrl+Shift+R para refrescar todos los datos
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.shiftKey && e.key === 'R') {
                    e.preventDefault();
                    console.log('‚å®Ô∏è Atajo de teclado: Refrescando datos...');
                    refreshAllData();
                }
            });
        }

        // Funci√≥n para parsear CSV
        function parseCSV(csv) {
            // Dividir por saltos de l√≠nea pero respetando comillas
            const lines = [];
            let currentLine = '';
            let inQuotes = false;
            
            for (let i = 0; i < csv.length; i++) {
                const char = csv[i];
                
                if (char === '"') {
                    inQuotes = !inQuotes;
                    currentLine += char;
                } else if (char === '\n' && !inQuotes) {
                    if (currentLine.trim()) {
                        lines.push(currentLine);
                    }
                    currentLine = '';
                } else {
                    currentLine += char;
                }
            }
            
            // Agregar la √∫ltima l√≠nea si existe
            if (currentLine.trim()) {
                lines.push(currentLine);
            }
            
            console.log('üîç Parseando CSV...');
            console.log('üìè Total de l√≠neas encontradas:', lines.length);
            
            if (lines.length === 0) {
                console.error('‚ùå No se encontraron l√≠neas en el CSV');
                return [];
            }
            
            const headers = parseCSVLine(lines[0]).map(h => h.trim().replace(/^"|"$/g, ''));
            console.log('üìã Headers encontrados:', headers);
            
            const data = [];

            for (let i = 1; i < lines.length; i++) {
                if (!lines[i].trim()) continue;
                
                const values = parseCSVLine(lines[i]);
                const row = {};
                
                headers.forEach((header, index) => {
                    let value = values[index] || '';
                    // Limpiar comillas al inicio y final
                    value = value.trim().replace(/^"|"$/g, '');
                    row[header] = value;
                });
                
                // Procesar temas y descripciones (solo para la hoja principal)
                if (row.temas && row.descripcionesTemas) {
                    const temasArray = row.temas.split(',').map(t => t.trim());
                    const descripcionesArray = row.descripcionesTemas.split(',').map(d => d.trim());
                    
                    row.temas = temasArray.map((nombre, index) => ({
                        nombre: nombre,
                        descripcion: descripcionesArray[index] || ''
                    }));
                }
                
                // Debug: mostrar las primeras 3 filas parseadas
                if (i <= 3) {
                    console.log(`üìÑ Fila ${i}:`, {
                        id: row.id,
                        partido: row.partido || row.nombre,
                        tema: row.tema,
                        tonoDiscursivo: row.tonoDiscursivo,
                        coherencia: row.coherencia
                    });
                }
                
                data.push(row);
            }
            
            console.log(`‚úÖ Total de registros parseados: ${data.length}`);
            return data;
        }

        // Funci√≥n auxiliar para parsear una l√≠nea CSV (maneja comillas)
        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                const nextChar = line[i + 1];
                
                if (char === '"') {
                    if (inQuotes && nextChar === '"') {
                        // Doble comilla dentro de campo entrecomillado = comilla literal
                        current += '"';
                        i++; // Saltar la siguiente comilla
                    } else {
                        // Toggle estado de comillas (no agregar las comillas al contenido)
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current);
            return result;
        }

        // Funci√≥n para cargar datos desde Google Sheets
        async function loadDataFromGoogleSheets() {
            const itemList = document.getElementById('itemList');
            const detailPanel = document.getElementById('detailPanel');
            
            // Mostrar mensaje de carga
            itemList.innerHTML = '<div style="padding: 20px; text-align: center; color: #999;">Cargando datos...</div>';
            detailPanel.innerHTML = '<div class="empty-state">Cargando...</div>';

            try {
                const response = await fetch(addCacheBuster(SPREADSHEET_URL));
                
                if (!response.ok) {
                    throw new Error('Error al cargar los datos');
                }
                
                const csvText = await response.text();
                allData = parseCSV(csvText);
                filteredData = allData.filter(item => item.tipo === currentTab);
                
                console.log('Datos cargados:', allData);
                
                if (allData.length === 0) {
                    itemList.innerHTML = '<div style="padding: 20px; text-align: center; color: #999;">No hay datos disponibles.<br><br>Verifica que tu Google Sheet est√© correctamente configurado.</div>';
                    detailPanel.innerHTML = '<div class="empty-state">No hay datos disponibles</div>';
                } else {
                    renderItems();
                    detailPanel.innerHTML = '<div class="empty-state">Selecciona un partido o candidato para ver los detalles</div>';
                }
                
            } catch (error) {
                console.error('Error cargando datos:', error);
                itemList.innerHTML = `
                    <div style="padding: 20px; text-align: center; color: #e74c3c;">
                        <p style="font-weight: bold; margin-bottom: 10px;">Error al cargar los datos</p>
                        <p style="font-size: 13px; line-height: 1.6;">
                            Verifica que:<br>
                            1. La URL del Google Sheet sea correcta<br>
                            2. El archivo est√© publicado como CSV<br>
                            3. Tengas conexi√≥n a internet
                        </p>
                    </div>
                `;
                detailPanel.innerHTML = '<div class="empty-state">Error al cargar los datos</div>';
            }
        }

        // Cambiar entre tabs
        function switchTab(tab) {
            currentTab = tab;
            
            // Actualizar UI de tabs
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            // Filtrar datos seg√∫n el tab
            filterItems();
        }

        // Filtrar items por b√∫squeda
        function filterItems() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            filteredData = allData.filter(item => {
                const matchesTab = item.tipo === currentTab;
                const matchesSearch = item.nombre.toLowerCase().includes(searchTerm) || 
                                     item.candidato.toLowerCase().includes(searchTerm);
                return matchesTab && matchesSearch;
            });
            
            renderItems();
        }

        // Renderizar lista de items
        function renderItems() {
            const itemList = document.getElementById('itemList');
            
            if (filteredData.length === 0) {
                itemList.innerHTML = '<div class="no-results">No se encontraron resultados</div>';
                return;
            }
            
            itemList.innerHTML = filteredData.map((item, index) => {
                const logoDisplay = item.logoUrl 
                    ? `<img src="${item.logoUrl}" alt="${item.nombre}" 
                           style="width: 100%; height: 100%; object-fit: contain; border-radius: 6px;"
                           onerror="this.style.display='none'; this.parentElement.innerHTML='üçé';">` 
                    : 'üçé';
                
                return `
                    <div class="party-item" data-id="${item.id}" data-index="${index}">
                        <div class="party-icon">${logoDisplay}</div>
                        <div class="party-name">${item.nombre}</div>
                    </div>
                `;
            }).join('');
            
            // Agregar event listeners despu√©s de renderizar
            document.querySelectorAll('.party-item').forEach(element => {
                element.addEventListener('click', function() {
                    const itemId = this.getAttribute('data-id');
                    selectItem(itemId, this);
                });
            });
        }

        // Seleccionar un item
        function selectItem(id, element) {
            const item = allData.find(i => i.id == id);
            
            if (!item) {
                console.error('Item no encontrado:', id);
                return;
            }
            
            // Actualizar UI de selecci√≥n
            document.querySelectorAll('.party-item').forEach(el => el.classList.remove('active'));
            if (element) {
                element.classList.add('active');
            }
            
            // Renderizar detalles
            renderDetails(item);
        }

        // Renderizar panel de detalles
        function renderDetails(item) {
            const detailPanel = document.getElementById('detailPanel');
            
            console.log('Renderizando detalles para:', item);
            
            // Validar que temas sea un array
            const temas = Array.isArray(item.temas) ? item.temas : [];
            
            const topicsHTML = temas.map(tema => `
                <div class="topic-tag">
                    ${tema.nombre}
                    <div class="info-icon">i</div>
                    <div class="tooltip">${tema.descripcion}</div>
                </div>
            `).join('');
            
            // Determinar si mostrar foto o avatar gen√©rico
            const avatarHTML = item.fotoUrl 
                ? `<img src="${item.fotoUrl}" alt="${item.candidato}" 
                       style="width: 100%; height: 100%;"
                       onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=\\'avatar-icon\\'></div><div class=\\'avatar-body\\'></div>';">` 
                : `<div class="avatar-icon"></div><div class="avatar-body"></div>`;
            
            // Preparar el bot√≥n de descarga
            const downloadButton = item.planUrl 
                ? `<a href="${item.planUrl}" target="_blank" class="btn btn-primary" style="text-decoration: none;">Descarga el plan</a>`
                : `<button class="btn btn-primary" disabled style="opacity: 0.5; cursor: not-allowed;">Plan no disponible</button>`;
            
            detailPanel.innerHTML = `
                <div class="candidate-profile">
                    <div class="box-main-avatar">
                        <div class="avatar">
                            ${avatarHTML}
                        </div>
                        <div class="candidate-name">${item.candidato || 'Sin informaci√≥n'}</div>
                        <div class="party-label">${item.nombrePartido || 'Sin informaci√≥n'}</div>
                    </div>   
                    <div class="box-main-buttons">
                        <div class="action-buttons">
                            ${downloadButton}
                            <button class="btn btn-secondary" onclick="addToCompare(${JSON.stringify(item).replace(/"/g, '&quot;')})">Comparar</button>
                        </div>
                    </div>  
                    <div class="candidate-info">
                        <div class="box-edad">  
                            <h6>edad:</h6>                                           
                            ${item.edad ? '' + item.edad : ''}
                        </div>
                        <div class="box-departamento">
                            <h6>departamento:</h6>         
                            ${item.ubicacion || ''}
                        </div> 
                    </div>
                    <div class="candidate-experiencia">
                        <h6>Experiencia laboral:</h6>
                        <p>${item.experienciaLaboral || 'Sin informaci√≥n de experiencia disponible.'}</p>
                    </div>
                    <div class="candidate-profesion">
                        <h6>Profesi√≥n:</h6>
                        <p>${item.profesion || ''} </p>
                    </div>
                    <div class="candidate-sentencias">
                        <h6>Sentencias:</h6>
                        <p>${item.sentencias || ''} </p>
                    </div>
                    <div class="candidate-ingresos">
                        <h6>Ingresos declarados:</h6>
                        <p>${item.ingresosDeclarados || ''} </p>
                    </div>
                </div>
                          
                

                <div class="vision-section">
                    <p class="vision-text">${item.vision || 'Sin informaci√≥n de visi√≥n disponible.'}</p>
                    
                    <div class="topics-section">
                        <h3>Revisi√≥n por temas</h3>
                        <div class="topics">
                            ${topicsHTML || '<p style="color: #999;">No hay temas disponibles</p>'}
                        </div>
                    </div>
                </div>
            `;
        }

        // Funci√≥n para scroll a la secci√≥n de comparar (implementar despu√©s)
        function scrollToCompare() {
            const comparisonSection = document.getElementById('comparisonSection');
            if (comparisonSection) {
                comparisonSection.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Iniciar la aplicaci√≥n cuando se carga la p√°gina
        window.onload = init;
    </script>
    
   
</body>
</html>